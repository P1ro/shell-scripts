$ echo $PS1
[PEXP\[\]ECT_PROMPT>

# Delete all aliases and function
# TODO: Instead start from pristine environment
$ unalias -a
$ alias | wc -l
$ for f in $(typeset -f | egrep '^\w+'); do unset -f $f; done
$ typeset -f | egrep '^\w+' | wc -l
# Setting a temp directory for tests
$ TMP=/tmp/test-extensionless
$ BIN_DIR=$PWD/..
0
0

$ alias | wc -l
0

$ temp_dir=$TMP/test-3573
$ mkdir -p "$temp_dir"
$ cd "$temp_dir"
$ pwd
#ALIAS FOR PRINTING SEPERATION LINES (FOR JUPYTER)
$ alias linebr="printf '%*s\n' "${COLUMNS:-$(tput cols)}" '' | tr ' ' -"
/tmp/test-extensionless/test-3573

# Count aliases proper
$ alias | wc -l
# Count functions
$ typeset -f | egrep '^\w+' | wc -l
1
0

## TESTS 1 - EXTENSIONLESS SHORTCUTS PT. 1
$ alias perl-=""
$ GREP='grep'
$ alias convert-termstrings='perl- convert_termstrings.perl'
$ alias do-rcsdiff='do_rcsdiff.sh'
$ alias dobackup='dobackup.sh'
$ alias kill-em='kill_em.sh'
$ alias kill-it='kill-em --pattern'

# # 1.1) NO EXAMPLES RN FOR kill-em and kill-it
# kill-em
# linebr
# kill-it
# # 1.2) TEST STOPS
# $ kill-em --pattern kcalc
# | pattern=/kcalc/
# | filter=/($)(^)/
# | OSTYPE: Undefined variable.

## 1.2) ERROR GENERATED - SCRIPT MISSING
# $ convert-termstrings
# | Can't open perl script "convert_termstrings.perl": No such file or directory

$ rm -rf ./*
$ printf "TOP\nTHIS IS A TEST\nBOTTOM" > test.txt
$ dobackup test.txt
$ linebr
$ ls
Backing up 'test.txt' to './backup/test.txt'
--------------------------------------------------------------------------------
backup	test.txt

## 1.3) do_rcsdiff
# $ do-rcsdiff Makefile
# | foreach: No match.

$ function ps-mine- { ps-mine "$@" | filter-dirnames; }
$ alias ps_mine='ps-mine'
$ alias ps-mine-all='ps-mine --all'

## ERROR - ps-mine COMMAND NOT FOUND
# ps_mine

$ alias rename-files='perl- rename_files.perl'
$ alias rename_files='rename-files'
$ alias testwn='perl- testwn.perl'
$ alias perlgrep='perl- perlgrep.perl'
$ alias foreach='perl- foreach.perl'
$ alias rename-spaces='rename-files -q global " " "_"'
$ alias rename-special-punct='rename-files -q -global -regex "[&\!\*?\(\)]" ""'

$ rm -rf ./*
$ touch abc.xyz def.xyz ooo.ppp
$ touch 'abc nounderscore.txt' abcdef\\.txt
$ ls
'abcdef\.txt'  'abc nounderscore.txt'   abc.xyz   def.xyz   ooo.ppp

#SINGLE FILE RENAME
$ rename_files -q ooo.ppp ooo.qqq
$ ls 
$ linebr
#EXTENSION RENAME 
$ rename_files -f .xyz .harry ./*
$ ls
$ linebr
#SPACES RENAME TO UNDERSCORES (need help)
$ rename-spaces -f
$ ls
$ linebr
#REMOVE SPECIAL CHARACTERS FROM FILENAME (need help)
$ rename-quotes -f 'abc nounderscore.txt'
$ ls
renaming "ooo.ppp" to "ooo.qqq"
'abcdef\.txt'  'abc nounderscore.txt'   abc.xyz   def.xyz   ooo.qqq
--------------------------------------------------------------------------------
renaming "./abc.xyz" to "./abc.harry"
renaming "./def.xyz" to "./def.harry"
'abcdef\.txt'   abc.harry  'abc nounderscore.txt'   def.harry   ooo.qqq
--------------------------------------------------------------------------------
WARNING: Ignoring -quick mode as files specified
'abcdef\.txt'   abc.harry  'abc nounderscore.txt'   def.harry   ooo.qqq
--------------------------------------------------------------------------------
bash: rename-quotes: command not found
'abcdef\.txt'   abc.harry  'abc nounderscore.txt'   def.harry   ooo.qqq

$ alias move-duplicates='mkdir -p duplicates; move *\([0-9]\).* duplicates 2>&1 | $GREP -iv cannot.stat.*..No.such'
$ alias rename-parens='rename-files -global -regex "[\(\)]" "" *[\(\)]*'
$ alias rename-etc='rename-spaces; rename-quotes; rename-special-punct; move-duplicates'

$ rm -rf ./*
# CREATING DUPLICATES 
$ touch 'abc(1).111' 'abc(2).111' 'xyz(3).111' 'xyz(4).111' '*abc.xyz' '&*abcdefg.xyz'
# REMOVES PARENTHESES () FROM FILENAMES
$ rename-parens
$ linebr
$ rename-special-punct
# rename-etc DOESN'T WORK WELL (move COMMAND NOT FOUND)
$ linebr
$ rename-etc
$ linebr
$ ls
renaming "abc(1).111" to "abc1.111"
renaming "abc(2).111" to "abc2.111"
renaming "xyz(3).111" to "xyz3.111"
renaming "xyz(4).111" to "xyz4.111"
--------------------------------------------------------------------------------
renaming "&*abcdefg.xyz" to "abcdefg.xyz"
renaming "*abc.xyz" to "abc.xyz"
--------------------------------------------------------------------------------
WARNING: Ignoring -quick mode as files specified
bash: rename-quotes: command not found
bash: move: command not found
--------------------------------------------------------------------------------
abc1.111  abc2.111  abcdefg.xyz  abc.xyz  duplicates  xyz3.111	xyz4.111

$ function move-versioned-files {
$     alias perl-grep='perl $BIN_DIR/perlgrep.perl'
$     alias dir-rw='dir -rw'
$     alias move='mv'
$     local ext_pattern='$1'
$     if [ '$ext_pattern' = '' ]; then ext_pattern='{list,log,txt}'; fi
$     local dir='$2'
$     if [ '$dir' = '' ]; then dir='versioned-files'; fi
$     mkdir -p '$dir';
$     local D='[-.]'
$     local file_list='$TEMP/_move-versioned-files-$$.list'
$     eval_middle='$(eval dir-rw *$D$ext_pattern[0-9]*  *$D*[0-9]*$D$ext_pattern  *$D$ext_pattern$D*[0-9][0-9]*   *$D*[0-9][0-9]*$D$ext_pattern  2>&1 | perl-grep -v "No such file" | perl -pe "s/(\S+\s+){6}\S+//;" | sort -u)'
$     move '$eval_middle' '$dir'
$ }
$ alias move-log-files='move-versioned-files "{log,debug}" "log-files"'
$ alias move-output-files='move-versioned-files "{csv,html,json,list,out,output,png,report,tsv,xml}" "output-files"'
$ alias move-adhoc-files='move-log-files; move-output-files'

# # SIMULATING THE CREATION OF LOG FILES AND OUTPUT FILES (need help)
# rm -rf ./*
# touch 'file1.log' 'file2.log' 'file3.debug' 'output1.html' 'output2.xml' 'output3.csv'
# move-log-files
# linebr
# move-output-files
# # OUTPUT
# mv: cannot stat 'dir:': No such file or directory
# mv: cannot stat 'invalid': No such file or directory
# mv: cannot stat 'line': No such file or directory
# mv: cannot stat 'width:': No such file or directory
# mv: cannot stat '‘*[-.]log[0-9]*’': No such file or directory
# --------------------------------------------------------------------------------
# mv: cannot stat 'dir:': No such file or directory
# mv: cannot stat 'invalid': No such file or directory
# mv: cannot stat 'line': No such file or directory
# mv: cannot stat 'width:': No such file or directory
# mv: cannot stat '‘*[-.]csv[0-9]*’': No such file or directory

$ function get-free-filename() {
$     local base="$1"
$     local sep="$2"
$     local L=1
$     local filename="$base"
$     while [ -e "$filename" ]; do
$         let L++
$         filename="$base$sep$L"
$     done;
$     echo "$filename"
$ }
$ function rename-with-file-date() {
$     local f new_f
$     local move_command="move"
$     if [ "$1" = "--copy" ]; then
$         move_command='command cp --interactive --verbose --preserve'
$         shift
$     fi
$     for f in "$@"; do
$         if [ -e "$f" ]; then
$            new_f=$(get-free-filename "$f".$(date --reference="$f" '+%d%b%y') ".")
$            eval "$move_command" "$f" "$new_f";
$         fi
$     done;
$ }
$ e
$ function copy-with-file-date { rename-with-file-date --copy "$@"; }
$ rm -rf ./*
$ touch abc1.xyz abc2.xyz abc3.xyz abc4.xyz abc5.xyz.19Aug22 abc6.xyz.19Aug22
$ ls
$ linebr
$ copy-with-file-date *.xyz 
$ linebr
$ ls
bash: e: command not found
abc1.xyz  abc2.xyz  abc3.xyz  abc4.xyz	abc5.xyz.19Aug22  abc6.xyz.19Aug22
--------------------------------------------------------------------------------
'abc1.xyz' -> 'abc1.xyz.06Oct22'
'abc2.xyz' -> 'abc2.xyz.06Oct22'
'abc3.xyz' -> 'abc3.xyz.06Oct22'
'abc4.xyz' -> 'abc4.xyz.06Oct22'
--------------------------------------------------------------------------------
abc1.xyz	  abc2.xyz.06Oct22  abc4.xyz	      abc6.xyz.19Aug22
abc1.xyz.06Oct22  abc3.xyz	    abc4.xyz.06Oct22
abc2.xyz	  abc3.xyz.06Oct22  abc5.xyz.19Aug22

# Statistical helpers
$ alias bigrams='perl -sw $BIN_DIR/count_bigrams.perl -N=2'
$ alias unigrams='perl -sw $BIN_DIR/count_bigrams.perl -N=1'
$ alias word-count=unigrams

$ rm -rf ./*
$ uname -r > catmanual.txt
$ bigrams catmanual.txt
$ ls
$ word-count catmanual.txt
$ ls
n/a:n/a	1
catmanual.txt
n/a	1
catmanual.txt

$ lynx-dump-stdout () { lynx -width=512 -dump "$@"; }
$ lynx-dump () { 
$     local in_file="$1"
$     shift 1
$     local base=$(basename "$file" .html)
$     if [[ ("$out_file" = "" ) && (! "$1" =~ -*) ]]; then
$         local out_file="$1"
$     fi
$     if [ "$out_file" = "" ]; then out_file="$base.txt"; fi
$     lynx-dump-stdout "$@" "$file" > "$out_file" 2> "$out_file.log"
$     if [ -s "$out_file.log" ]; then
$         cat "$out_file.log"
$         delete-force "$out_file.log"
$     fi
$ }
$ if [ "$BAREBONES_HOST" = "1" ]; then export lynx_width=0; fi
$ alias lynx-html='lynx -force_html'

# TROUBLES WITH BATSPP
# $ lynx-dump-stdout | head

#lynx-html (is a continuously running program)
$ printf "https://www.google.com/" > lynxin.txt
# lynx-dump lynxin.txt (need help)

# CSH-like aliases
#
$ function setenv () { export $1="$2"; }
$ alias unsetenv='unset'
$ alias unexport='unset'

$ setenv MY_USERNAME aveey-temp
$ echo $MY_USERNAME
$ linebr
$ unexport MY_USERNAME
$ echo $MY_USERNAME
aveey-temp
--------------------------------------------------------------------------------
